---
title: Log Analytics のクエリの実行コストについて
date: 2025-09-12 00:00:00
tags:
  - How-To
  - クエリ
  - コスト
  - Log Analytics
---

こんにちは、Azure Monitoring サポート チームの六浦です。

今回は Log Analytics でクエリを実行する際のコストについてご説明します。

<!-- more -->

## 目次
- [1. クエリ実行のコストに関わる設定の確認](#1-クエリ実行のコストに関わる設定の確認)
- [2. Analytics のリテンション期間のログに対してクエリを実行する場合](#2-Analytics-のリテンション期間のログに対してクエリを実行する場合)
  - [2-1. Analytics テーブル プランの場合](#2-1-Analytics-テーブル-プランの場合)
  - [2-2. 基本 (Basic) テーブル プランと補助 (Auxiliary) テーブル プランの場合](#2-2-基本-Basic-テーブル-プランと補助-Auxiliary-テーブル-プランの場合)
- [3. 長期保持 (アーカイブ) 期間のログに対してクエリを実行する場合](#3-長期保持-アーカイブ-期間のログに対してクエリを実行する場合)
  - [3-1. 検索ジョブのコスト](#3-1-検索ジョブのコスト)
  - [3-2. 復元のコスト](#3-2-復元のコスト)
- [4. まとめ](#4-まとめ)

<br>

## 1. クエリ実行のコストに関わる設定の確認
Azure ポータルの Log Analytics ワークスペースの [設定] > [テーブル] より、クエリを実行するテーブルの以下の設定を確認します。

| 設定                         | 設定可能な値                           |
| ---------------------------- | -------------------------------------- |
| プラン                       | Analytics、基本、補助 のいずれかです。 |
| Analytics のリテンション期間 | 最大 2 年まで設定できます。            |
| 保有期間の合計               | 最大 12 年まで設定できます。           |


これらの設定によって、クエリ実行時のコストが決まります。


<br>

## 2. Analytics のリテンション期間のログに対してクエリを実行する場合
[1. クエリ実行のコストに関わる設定の確認](#1-クエリ実行のコストに関わる設定の確認) の [プラン] によってクエリの実行コストは異なります。

<br>

### 2-1. Analytics テーブル プランの場合
**無料**でクエリを実行できます。
Analytics テーブル プランはデフォルトのテーブル プランのため、多くのテーブルに該当します。

<br>

### 2-2. 基本 (Basic) テーブル プランと補助 (Auxiliary) テーブル プランの場合
クエリ実行時にスキャンしたデータ量に応じたコストが発生します。
料金は[価格についての公開情報](https://azure.microsoft.com/ja-jp/pricing/details/monitor/)の [クエリ] からご確認ください。

例えば、2 GB のデータに対してクエリを実行した際のコストは以下の式で算出できます。
`$0.00725 * 2 GB = $0.0145`
※ 計算には東日本リージョンの従量課金制の USD 価格を利用しています


なお、基本および補助テーブルのログに対して実行できるクエリには制限があります。
制限については、[こちら](https://learn.microsoft.com/ja-jp/azure/azure-monitor/logs/basic-logs-query?tabs=portal-1)をご確認ください。


> [!NOTE]
> Basic テーブル プランは一部のテーブルで利用できます。対象のテーブルは[こちら](https://learn.microsoft.com/ja-jp/azure/azure-monitor/logs/basic-logs-azure-tables)を確認ください。
> Auxiliary テーブル プランは DCR ベースのカスタム テーブルのみで利用できます。
> テーブル プランの詳細については[こちら](https://learn.microsoft.com/ja-jp/azure/azure-monitor/logs/data-platform-logs#table-plans)の公開情報もご確認ください。

<br>

## 3. 長期保持 (アーカイブ) 期間のログに対してクエリを実行する場合
長期保持期間は、[1. クエリ実行のコストに関わる設定の確認](#1-クエリ実行のコストに関わる設定の確認)の [保有期間の合計] から [Analytics のリテンション期間] を引いた期間です。
長期保持期間のログに対するクエリ実行には、テーブル プランに関わらず、[検索ジョブ]((https://learn.microsoft.com/ja-jp/azure/azure-monitor/logs/search-jobs?tabs=portal-1%2Cportal-2))の実行、または[ログの復元](https://learn.microsoft.com/ja-jp/azure/azure-monitor/logs/restore?tabs=api-1)のコストがかかります。
なお、検索ジョブで作成される結果テーブルのログと復元されたログは、Analytics テーブル プランのログのため、クエリ実行による追加のコストは発生しません。


> [!NOTE]
> 現在 Auxiliary テーブル プランは復元をサポートしません。Auxiliary テーブルから長期保持されているデータを取得するには、検索ジョブをご利用ください。

<br>

### 3-1. 検索ジョブのコスト
検索ジョブは、「スキャンされたデータのコスト」と「検索結果の取り込みのコスト」が発生します。
「スキャンされたデータのコスト」は、[価格についての公開情報](https://azure.microsoft.com/ja-jp/pricing/details/monitor/)の [ジョブの検索] の価格です。
「検索結果の取り込みのコスト」は[価格についての公開情報](https://azure.microsoft.com/ja-jp/pricing/details/monitor/) の [インジェスト] の Analytics ログの価格です。


例えば、1000 GB のログを検索ジョブでスキャンして、100 GB の結果を得た際のコストは以下のように計算できます。
`$0.00725 * 1000 GB + $3.34 * 100 GB = $341.25`

※ 計算には東日本リージョンの従量課金制の USD 価格を利用しています。


<br>

### 3-2. 復元のコスト
復元のコストは、[価格についての公開情報](https://azure.microsoft.com/ja-jp/pricing/details/monitor/)の [復元] をご確認ください。

復元のコストの計算には 2 つの注意点があります。
- 復元したデータを 12 時間未満保持した際、12 時間に保持したとして計算します。
- 2 TB 未満のデータを復元した際、データ量は 2 TB に切り上げて計算します。

つまり、復元には少なくとも 2 TB (2000 GB) を 12 時間保持する下記のコストが発生します。
` $0.145 * 2000 GB * 12/24 (日) = $145`

他にもいくつか例をご紹介します。
- 1 TB のデータを 1 日保持した場合
` $0.145 * 2000 GB * 1 (日) = $290`
1 TB は 2 TB に切り上げられます。

- 2 TB のデータを 13 時間保持した場合
` $0.145 * 2000 GB * 13/24 (日) = $157.09`
復元したデータを保持する期間は時間単位で課金されます。

- 3 TB のデータを 2 日間保持した場合
` $0.145 * 3000 GB * 2 (日) = $870`


※ 計算には東日本リージョンの従量課金制の USD 価格を利用しています


<br>

## 4. まとめ
本記事では、クエリ実行時のコストについてご案内いたしましたが、いかがでしたでしょうか。
Log Analytics ワークスペースのその他のコストについてはこれらの公開情報にてご案内しておりますので、合わせてご覧ください。
[Azure Monitor ログのコストの計算とオプション](https://learn.microsoft.com/ja-jp/azure/azure-monitor/logs/cost-logs)
[Log Analytics ワークスペースのコスト増加の原因を分析しコスト削減を検討する](https://jpazmon-integ.github.io/blog/LogAnalytics/HowToManageLogAnalyticsBilling/)


最後までお読みいただきありがとうございました！
